- name: cloudtrail_only_logs_after_multiple_calls
  description: CloudTrail only_logs_after multiple calls configurations
  configuration_parameters:
    BUCKET_TYPE: cloudtrail
    BUCKET_NAME: bongosec-cloudtrail-integration-tests
  metadata:
    resource_type: bucket
    bucket_type: cloudtrail
    bucket_name: bongosec-cloudtrail-integration-tests
    only_logs_after: 2022-NOV-20
    expected_results: 1

- name: vpc_only_logs_after_multiple_calls
  description: VPC only_logs_after multiple calls configurations
  configuration_parameters:
    BUCKET_TYPE: vpcflow
    BUCKET_NAME: bongosec-vpcflow-integration-tests
  metadata:
    resource_type: bucket
    vpc_name: bongosec-vpc-integration-tests
    bucket_type: vpcflow
    bucket_name: bongosec-vpcflow-integration-tests
    only_logs_after: 2022-NOV-20
    expected_results: 1

- name: config_only_logs_after_multiple_calls
  description: Config only_logs_after multiple calls configurations
  configuration_parameters:
    BUCKET_TYPE: config
    BUCKET_NAME: bongosec-config-integration-tests
  metadata:
    resource_type: bucket
    bucket_type: config
    bucket_name: bongosec-config-integration-tests
    only_logs_after: 2022-NOV-20
    expected_results: 1

- name: alb_only_logs_after_multiple_calls
  description: ALB only_logs_after multiple calls configurations
  configuration_parameters:
    BUCKET_TYPE: alb
    BUCKET_NAME: bongosec-alb-integration-tests
  metadata:
    resource_type: bucket
    bucket_type: alb
    bucket_name: bongosec-alb-integration-tests
    only_logs_after: 2022-NOV-20
    expected_results: 1

- name: clb_only_logs_after_multiple_calls
  description: CLB only_logs_after multiple calls configurations
  configuration_parameters:
    BUCKET_TYPE: clb
    BUCKET_NAME: bongosec-clb-integration-tests
  metadata:
    resource_type: bucket
    bucket_type: clb
    bucket_name: bongosec-clb-integration-tests
    only_logs_after: 2022-NOV-20
    expected_results: 1

- name: nlb_only_logs_after_multiple_calls
  description: NLB only_logs_after multiple calls configurations
  configuration_parameters:
    BUCKET_TYPE: nlb
    BUCKET_NAME: bongosec-nlb-integration-tests
  metadata:
    resource_type: bucket
    bucket_type: nlb
    bucket_name: bongosec-nlb-integration-tests
    only_logs_after: 2022-NOV-20
    expected_results: 1

- name: kms_only_logs_after_multiple_calls
  description: KMS only_logs_after multiple calls configurations
  configuration_parameters:
    BUCKET_TYPE: custom
    BUCKET_NAME: bongosec-kms-integration-tests
  metadata:
    resource_type: bucket
    bucket_type: custom
    bucket_name: bongosec-kms-integration-tests
    only_logs_after: 2022-NOV-20
    expected_results: 1

- name: macie_only_logs_after_multiple_calls
  description: Macie only_logs_after multiple calls configurations
  configuration_parameters:
    BUCKET_TYPE: nlb
    BUCKET_NAME: bongosec-nlb-integration-tests
  metadata:
    resource_type: bucket
    bucket_type: custom
    bucket_name: bongosec-macie-integration-tests
    only_logs_after: 2022-NOV-20
    expected_results: 1

- name: trusted_advisor_only_logs_after_multiple_calls
  description: Trusted Advisor only_logs_after multiple calls configurations
  configuration_parameters:
    BUCKET_TYPE: custom
    BUCKET_NAME: bongosec-trusted-advisor-integration-tests
  metadata:
    resource_type: bucket
    bucket_type: custom
    bucket_name: bongosec-trusted-advisor-integration-tests
    only_logs_after: 2022-NOV-20
    expected_results: 1

- name: guardduty_only_logs_after_multiple_calls
  description: GuardDuty only_logs_after multiple calls configurations
  configuration_parameters:
    BUCKET_TYPE: guardduty
    BUCKET_NAME: bongosec-guardduty-integration-tests
  metadata:
    resource_type: bucket
    bucket_type: guardduty
    bucket_name: bongosec-guardduty-integration-tests
    only_logs_after: 2022-NOV-20
    expected_results: 1

- name: native_guardduty_only_logs_after_multiple_calls
  description: Native GuardDuty only_logs_after multiple calls configurations
  configuration_parameters:
    BUCKET_TYPE: guardduty
    BUCKET_NAME: bongosec-native-guardduty-integration-tests
  metadata:
    resource_type: bucket
    bucket_type: guardduty
    bucket_name: bongosec-native-guardduty-integration-tests
    only_logs_after: 2022-NOV-20
    expected_results: 1

- name: waf_only_logs_after_multiple_calls
  description: WAF only_logs_after multiple calls configurations
  configuration_parameters:
    BUCKET_TYPE: waf
    BUCKET_NAME: bongosec-waf-integration-tests
  metadata:
    resource_type: bucket
    bucket_type: waf
    bucket_name: bongosec-waf-integration-tests
    only_logs_after: 2022-NOV-20
    expected_results: 1

- name: server_access_only_logs_after_multiple_calls
  description: Server Access only_logs_after multiple calls configurations
  configuration_parameters:
    BUCKET_TYPE: server_access
    BUCKET_NAME: bongosec-server-access-integration-tests
  metadata:
    resource_type: bucket
    bucket_type: server_access
    bucket_name: bongosec-server-access-integration-tests
    only_logs_after: 2022-NOV-20
    expected_results: 1

- name: cisco_umbrella_only_logs_after_multiple_calls
  description: Umbrella only_logs_after multiple calls configurations
  configuration_parameters:
    BUCKET_TYPE: cisco_umbrella
    BUCKET_NAME: bongosec-umbrella-integration-tests
    PATH: dnslogs
  metadata:
    resource_type: bucket
    bucket_type: cisco_umbrella
    bucket_name: bongosec-umbrella-integration-tests
    only_logs_after: 2022-NOV-20
    path: dnslogs
    expected_results: 1
